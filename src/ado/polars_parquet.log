--------------------------------------------------------------------------------
      name:  <unnamed>
       log:  C:\Users\jonro\OneDrive\Documents\Coding\stata_parquet_io\src\ado\p
> olars_parquet.log
  log type:  text
 opened on:   5 May 2022, 00:01:28

. 
. /*
> // Initialize plugin
> if "`c(os)'" == "MacOSX" {
>   local plugin_extension = "dylib"
> } 
> else if "`c(os)'" == "Windows" {
>   local plugin_extension = "dll"
> } 
> else {
>   local plugin_extension = "so"
> }
> program polars_parquet_plugin, plugin using("C:\Users\jonro\OneDrive\Documents
> \Coding\stata_parquet_io\target\release\stata_parquet_io.`plugin_extension'")
> */
. if (0${pq_plugin_loaded} == 0) {
. 
.     // Plugin is not loaded, so initialize it
.     if "`c(os)'" == "MacOSX" {
.           local plugin_extension = "dylib"
.         } 
.         else if "`c(os)'" == "Windows" {
.           local plugin_extension = "dll"
.         } 
.         else {
.           local plugin_extension = "so"
.         }
.         program polars_parquet_plugin, plugin using("C:\Users\jonro\OneDrive\D
> ocuments\Coding\stata_parquet_io\target\release\stata_parquet_io.`plugin_exten
> sion'")
.         
.         global pq_plugin_loaded = 1
. }

. else {
.     // Plugin is already loaded, no need to reload
. }

. 
. timer clear

. 
. //      local path C:/Users/jonro/Downloads/pyreadstat/test_data/basic/sample
. //      local path C:\Users\jonro\Downloads\flights-1m
. //      local path C:\Users\jonro\Downloads\fhv_tripdata_2025-01
. local path C:\Users\jonro\Downloads\fhvhv_tripdata_2024-12

. pq_describe using "`path'.parquet"
Variable Name                    | Polars Type                      | Stata Type
-------------------------------- | -------------------------------- | ----------
> ---------- 
hvfhs_license_num                | String                           | string
dispatching_base_num             | String                           | string
originating_base_num             | String                           | string
request_datetime                 | Datetime(Microseconds, None)     | datetime
on_scene_datetime                | Datetime(Microseconds, None)     | datetime
pickup_datetime                  | Datetime(Microseconds, None)     | datetime
dropoff_datetime                 | Datetime(Microseconds, None)     | datetime
PULocationID                     | Int32                            | long
DOLocationID                     | Int32                            | long
trip_miles                       | Float64                          | double
trip_time                        | Int64                            | double
base_passenger_fare              | Float64                          | double
tolls                            | Float64                          | double
bcf                              | Float64                          | double
sales_tax                        | Float64                          | double
congestion_surcharge             | Float64                          | double
airport_fee                      | Float64                          | double
tips                             | Float64                          | double
driver_pay                       | Float64                          | double
shared_request_flag              | String                           | string
shared_match_flag                | String                           | string
access_a_ride_flag               | String                           | string
wav_request_flag                 | String                           | string
wav_match_flag                   | String                           | string

n columns = 24
n rows = 21068851

. timer on 1

. pq_use using "`path'.parquet"
using "C:\Users\jonro\Downloads\fhvhv_tripdata_2024-12.parquet"
namelist: 
rest: "C:\Users\jonro\Downloads\fhvhv_tripdata_2024-12.parquet"
namelist: 
using:    C:\Users\jonro\Downloads\fhvhv_tripdata_2024-12.parquet
if:       
in:        
sql_if:    
plugin call polars_parquet_plugin, function: read "C:\Users\jonro\Downloads\fhvh
> v_tripdata_2024-12.parquet" "hvfhs_license_num dispatching_base_num originatin
> g_base_num request_datetime on_scene_datetime pickup_datetime dropoff_datetime
>  PULocationID DOLocationID trip_miles trip_time base_passenger_fare tolls bcf 
> sales_tax congestion_surcharge airport_fee tips driver_pay shared_request_flag
>  shared_match_flag access_a_ride_flag wav_request_flag wav_match_flag" n_rows:
>  21068851 offset: 0 if: "" mapping: "[{"name":"hvfhs_license_num","dtype":"Str
> ing","stata_type":"string"},{"name":"dispatching_base_num","dtype":"String","s
> tata_type":"string"},{"name":"originating_base_num","dtype":"String","stata_ty
> pe":"string"},{"name":"request_datetime","dtype":"Datetime(Microseconds, None)
> ","stata_type":"datetime"},{"name":"on_scene_datetime","dtype":"Datetime(Micro
> seconds, None)","stata_type":"datetime"},{"name":"pickup_datetime","dtype":"Da
> tetime(Microseconds, None)","stata_type":"datetime"},{"name":"dropoff_datetime
> ","dtype":"Datetime(Microseconds, None)","stata_type":"datetime"},{"name":"PUL
> ocationID","dtype":"Int32","stata_type":"long"},{"name":"DOLocationID","dtype"
> :"Int32","stata_type":"long"},{"name":"trip_miles","dtype":"Float64","stata_ty
> pe":"double"},{"name":"trip_time","dtype":"Int64","stata_type":"double"},{"nam
> e":"base_passenger_fare","dtype":"Float64","stata_type":"double"},{"name":"tol
> ls","dtype":"Float64","stata_type":"double"},{"name":"bcf","dtype":"Float64","
> stata_type":"double"},{"name":"sales_tax","dtype":"Float64","stata_type":"doub
> le"},{"name":"congestion_surcharge","dtype":"Float64","stata_type":"double"},{
> "name":"airport_fee","dtype":"Float64","stata_type":"double"},{"name":"tips","
> dtype":"Float64","stata_type":"double"},{"name":"driver_pay","dtype":"Float64"
> ,"stata_type":"double"},{"name":"shared_request_flag","dtype":"String","stata_
> type":"string"},{"name":"shared_match_flag","dtype":"String","stata_type":"str
> ing"},{"name":"access_a_ride_flag","dtype":"String","stata_type":"string"},{"n
> ame":"wav_request_flag","dtype":"String","stata_type":"string"},{"name":"wav_m
> atch_flag","dtype":"String","stata_type":"string"}]"

. timer off 1

. sum

    Variable |        Obs        Mean    Std. dev.       Min        Max
-------------+---------------------------------------------------------
hvfhs_lice~m |          0
dispatchin~m |          0
originatin~m |          0
request_da~e | 21,068,851    2.05e+12    7.49e+08   2.05e+12   2.05e+12
on_scene_d~e | 15,947,213    2.05e+12    7.45e+08   2.05e+12   2.05e+12
-------------+---------------------------------------------------------
pickup_dat~e | 21,068,851    2.05e+12    7.49e+08   2.05e+12   2.05e+12
dropoff_da~e | 21,068,851    2.05e+12    7.48e+08   2.05e+12   2.05e+12
PULocationID | 21,068,851    138.2474    74.87559          1        265
DOLocationID | 21,068,851    141.7931    78.08619          1        265
  trip_miles | 21,068,851    5.102387    6.037739          0     555.25
-------------+---------------------------------------------------------
   trip_time | 21,068,851    1234.268    922.9572          0      30150
base_passe~e | 21,068,851    27.92431    25.98292     -25.59    2473.36
       tolls | 21,068,851    1.226872    4.194198          0     109.61
         bcf | 21,068,851    .7739698    .7407186          0      68.02
   sales_tax | 21,068,851     2.29519    2.083622          0     101.47
-------------+---------------------------------------------------------
congestion~e | 21,068,851    .9935359    1.314927          0        5.5
 airport_fee | 21,068,851    .2141851    .7019873          0       7.25
        tips | 21,068,851    1.285674    3.871478          0     336.21
  driver_pay | 21,068,851    21.53272    18.48767    -105.38     1237.6
shared_req~g |          0
-------------+---------------------------------------------------------
shared_mat~g |          0
access_a_r~g |          0
wav_reques~g |          0
wav_match_~g |          0

. save "`path'.dta", replace
(file C:\Users\jonro\Downloads\fhvhv_tripdata_2024-12.dta not found)
file C:\Users\jonro\Downloads\fhvhv_tripdata_2024-12.dta saved

. 
. timer on 2

. use "`path'", clear

. timer off 2

. sum

    Variable |        Obs        Mean    Std. dev.       Min        Max
-------------+---------------------------------------------------------
hvfhs_lice~m |          0
dispatchin~m |          0
originatin~m |          0
request_da~e | 21,068,851    2.05e+12    7.49e+08   2.05e+12   2.05e+12
on_scene_d~e | 15,947,213    2.05e+12    7.45e+08   2.05e+12   2.05e+12
-------------+---------------------------------------------------------
pickup_dat~e | 21,068,851    2.05e+12    7.49e+08   2.05e+12   2.05e+12
dropoff_da~e | 21,068,851    2.05e+12    7.48e+08   2.05e+12   2.05e+12
PULocationID | 21,068,851    138.2474    74.87559          1        265
DOLocationID | 21,068,851    141.7931    78.08619          1        265
  trip_miles | 21,068,851    5.102387    6.037739          0     555.25
-------------+---------------------------------------------------------
   trip_time | 21,068,851    1234.268    922.9572          0      30150
base_passe~e | 21,068,851    27.92431    25.98292     -25.59    2473.36
       tolls | 21,068,851    1.226872    4.194198          0     109.61
         bcf | 21,068,851    .7739698    .7407186          0      68.02
   sales_tax | 21,068,851     2.29519    2.083622          0     101.47
-------------+---------------------------------------------------------
congestion~e | 21,068,851    .9935359    1.314927          0        5.5
 airport_fee | 21,068,851    .2141851    .7019873          0       7.25
        tips | 21,068,851    1.285674    3.871478          0     336.21
  driver_pay | 21,068,851    21.53272    18.48767    -105.38     1237.6
shared_req~g |          0
-------------+---------------------------------------------------------
shared_mat~g |          0
access_a_r~g |          0
wav_reques~g |          0
wav_match_~g |          0

. timer list
   1:     23.73 /        1 =      23.7320
   2:      1.99 /        1 =       1.9940

. //      pq_describe using "C:/Users/jonro/Downloads/pyreadstat/test_data/basic
> /sample.parquet"
. //      return list
. //      pq_use using "C:/Users/jonro/Downloads/pyreadstat/test_data/basic/samp
> le.parquet", // in(2/3) //        if(mynum > 0 | missing(mynum) | mytime > 1.1
> )
. ;
; is not a valid command name
r(199);

end of do-file

r(199);

. exit, clear
